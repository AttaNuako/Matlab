
% Specify the file name and sheet name
file = 'taxdata.xlsx';
sheet = 'Sheet1';

% Read the data from the Excel sheet
[num,txt,raw] = xlsread(file, sheet);

% Display the data
disp('Numeric Data:');
disp(num);
disp('Text Data:');
disp(txt);
disp('Raw Data:');
disp(raw);


% Load the data from the provided dataset
data = [35.00 	23.54 	23.80 	19.51 	14.51 	24.00 	35.00 	34.00 
20.00 	11.48 	12.46 	16.00 	0.53 	20.00 	20.00 	50.00 
30.00 	21.96 	23.03 	11.38 	0.24 	10.00 	47.00 	12.00 
34.00 	20.86 	21.04 	25.11 	0.19 	20.00 	50.00 	20.00 
33.99 	16.71 	19.57 	24.27 	0.54 	21.00 	50.00 	10.00 
25.00 	39.87 	39.87 	10.18 	17.58 	14.94 	13.00 	41.00 
34.00 	15.49 	15.49 	31.45 	4.32 	73.54 	27.50 	23.00 
19.50 	8.60 	10.24 	26.36 	1.02 	20.00 	29.00 	27.00 
35.00 	22.28 	22.54 	13.99 	4.07 	18.00 	35.00 	45.00 
36.12 	21.78 	25.93 	7.04 	4.52 	15.00 	29.00 	10.00 
17.00 	15.09 	15.09 	2.04 	2.17 	19.00 	40.00 	10.00 
33.00 	15.75 	15.75 	36.71 	0.88 	18.87 	45.00 	48.00 
38.50 	24.28 	24.28 	23.64 	4.40 	16.97 	35.00 	68.00 
20.06 	6.04 	11.90 	14.16 	0.00 	22.07 	45.00 	39.00 
28.00 	9.29 	13.00 	29.68 	0.02 	19.00 	32.00 	14.00 
30.00 	21.94 	24.53 	0.61 	1.14 	25.00 	59.00 	18.00 
25.00 	26.58 	26.58 	10.62 	0.99 	13.00 	25.00 	87.00 
25.00 	18.90 	19.08 	10.30 	0.77 	12.00 	25.00 	8.00 
34.00 	17.07 	20.43 	21.74 	0.51 	10.00 	32.00 	42.00 
29.00 	16.30 	18.84 	18.04 	0.73 	22.00 	34.00 	19.00 
35.43 	14.06 	14.42 	37.65 	3.32 	21.10 	48.09 	33.00 
20.00 	11.06 	11.06 	26.29 	1.36 	20.50 	20.00 	48.00 
37.07 	23.50 	23.60 	16.75 	0.04 	16.00 	45.00 	32.00 
35.00 	19.55 	22.48 	10.60 	0.01 	13.54 	30.00 	35.00 
35.00 	19.78 	19.91 	23.80 	0.21 	18.00 	40.00 	33.00 
17.50 	0.00 	12.25 	3.95 	0.00 	0.00 	17.00 	4.00 
18.00 	9.48 	9.62 	31.01 	5.26 	27.20 	38.00 	24.00 
36.59 	20.28 	24.29 	14.21 	3.28 	25.65 	30.00 	59.00 
30.00 	20.84 	21.01 	8.00 	0.09 	10.00 	35.00 	52.00 
12.50 	9.62 	9.62 	9.12 	0.00 	21.00 	42.00 	8.00 
35.00 	25.72 	25.98 	5.04 	1.19 	17.17 	49.00 	33.00 
37.25 	23.82 	23.82 	35.23 	0.27 	20.00 	45.00 	15.00 
33.33 	19.67 	23.42 	9.75 	0.95 	15.00 	25.00 	72.00 
42.05 	28.66 	31.64 	10.00 	2.16 	5.00 	37.00 	15.00 
15.72 	12.24 	12.28 	9.33 	0.45 	16.00 	25.00 	26.00 
30.00 	18.79 	20.62 	14.96 	1.69 	15.00 	20.00 	34.00 
30.00 	23.62 	24.84 	5.44 	4.90 	16.30 	30.00 	17.00 
26.73 	14.94 	18.38 	5.87 	0.65 	10.00 	36.00 	27.00 
20.00 	9.94 	11.88 	21.20 	0.44 	26.30 	33.00 	89.00 
15.00 	5.20 	8.47 	20.40 	0.44 	18.00 	25.00 	41.00 
15.00 	10.20 	10.24 	18.23 	0.00 	10.00 	20.00 	21.00 
15.00 	4.14 	7.25 	26.21 	1.08 	18.48 	33.00 	13.00 
30.00 	16.43 	19.99 	14.21 	1.24 	20.00 	35.00 	27.00 
30.00 	17.32 	25.07 	0.85 	0.00 	17.50 	40.00 	29.00 
28.00 	10.50 	16.13 	9.79 	0.35 	10.00 	28.00 	35.00 
35.00 	20.97 	21.23 	17.73 	3.33 	18.00 	15.00 	60.00 
33.00 	22.21 	22.48 	18.46 	0.70 	15.00 	33.00 	49.00 
30.00 	0.00 	6.63 	15.27 	0.30 	15.00 	40.00 	42.00 
35.00 	17.74 	22.33 	16.71 	0.27 	20.00 	44.00 	28.00 
32.00 	25.59 	25.59 	3.39 	1.35 	17.00 	32.00 	36.00 
34.50 	25.62 	25.62 	12.90 	0.50 	19.00 	52.00 	22.00 
33.00 	26.44 	28.45 	0.00 	0.12 	12.50 	39.00 	9.00 
32.00 	20.69 	21.99 	6.54 	0.40 	5.00 	25.00 	35.00 
28.00 	18.50 	20.33 	11.96 	0.00 	24.00 	12.20 	3.00 
41.00 	31.28 	32.42 	9.77 	0.53 	15.00 	35.00 	47.00 
30.00 	16.88 	20.25 	10.39 	7.62 	5.00 	30.00 	59.00 
30.00 	22.03 	23.57 	8.27 	1.83 	19.00 	30.00 	53.00 
32.00 	22.08 	22.88 	7.24 	3.14 	10.68 	32.00 	59.00 
19.00 	11.54 	12.47 	16.01 	0.98 	22.00 	40.00 	43.00 
27.50 	16.03 	16.10 	20.07 	0.71 	19.00 	40.00 	7.00 
25.00 	15.17 	15.35 	27.35 	0.53 	19.00 	40.00 	89.00 
24.00 	12.62 	12.98 	29.41 	2.30 	18.00 	13.00 	74.00 
33.00 	22.01 	22.34 	15.06 	5.06 	18.00 	50.00 	59.00 
20.00 	10.25 	13.17 	10.68 	2.18 	5.00 	22.00 	16.00 
19.00 	5.40 	8.63 	29.03 	0.22 	19.00 	19.00 	31.00 
25.00 	14.38 	15.76 	14.64 	0.29 	20.00 	50.00 	34.00 
30.00 	18.10 	22.69 	1.99 	2.01 	14.14 	40.00 	23.00 
35.00 	18.52 	18.61 	33.23 	0.18 	16.00 	45.00 	7.00 
32.50 	23.00 	23.09 	12.72 	1.66 	16.00 	30.00 	60.00 
28.00 	10.47 	14.93 	27.16 	0.33 	25.00 	25.00 	5.00 
24.10 	13.74 	16.18 	8.57 	0.45 	7.60 	11.50 	13.00 
25.00 	17.83 	18.01 	7.73 	1.87 	5.00 	40.00 	15.00 
30.00 	18.05 	20.69 	13.57 	0.08 	20.30 	30.00 	48.00 
30.00 	22.04 	22.26 	4.18 	3.79 	7.00 	37.00 	46.00 
35.00 	20.63 	23.45 	15.27 	0.00 	19.24 	35.00 	45.00 
30.00 	16.92 	16.92 	22.96 	0.34 	18.00 	40.00 	18.00 
30.00 	19.42 	21.94 	8.48 	0.43 	17.50 	30.00 	31.00 
25.00 	10.68 	13.16 	31.51 	0.09 	20.00 	13.00 	98.00 
30.00 	18.61 	21.44 	8.19 	1.10 	17.50 	40.00 	7.00 
45.20 	18.19 	31.99 	7.18 	4.56 	8.25 	35.00 	10.00 
30.00 	25.45 	25.53 	3.07 	0.00 	26.00 	0.00 	41.00 
34.00 	19.21 	19.72 	13.32 	2.80 	16.48 	34.00 	68.00 
28.00 	18.37 	18.79 	14.42 	0.17 	10.00 	60.00 	32.00 
35.00 	17.68 	25.32 	4.24 	0.00 	17.50 	30.00 	37.00 
30.90 	14.66 	20.23 	3.52 	4.87 	15.00 	45.00 	59.00 
];

% Extract labor tax amounts
labor_tax = data(:, 4);

% Calculate minimum, average, and maximum labor tax amounts
min_tax = min(labor_tax);
avg_tax = mean(labor_tax);
max_tax = max(labor_tax);

% Create bar graph
bar_data = [min_tax, avg_tax, max_tax];
bar_labels = {'Minimum', 'Average', 'Maximum'};
bar(bar_data);
xticklabels(bar_labels);
ylabel('Labor Tax Amount');
title('Minimum, Average, and Maximum Labor Tax Amounts');

% Display the values on top of the bars
text(1:length(bar_data), bar_data, num2str(bar_data', '%.2f'), ...
    'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom');

% Display the plot
grid on;


% Load the dataset
data = readtable('taxdata.xlsx');

% Extract relevant columns
num_tax_payments = data.Number_of_tax_payments;
labor_tax = data.Labor_tax;

% Fit polynomial functions of different orders
orders = 1:10; % Polynomial orders to try
rsquared_values = zeros(size(orders));

for i = 1:length(orders)
    order = orders(i);
    
    % Fit polynomial
    p = polyfit(num_tax_payments, labor_tax, order);
    
    % Evaluate goodness of fit (R-squared value)
    y_fit = polyval(p, num_tax_payments);
    rsquared_values(i) = 1 - sum((labor_tax - y_fit).^2) / sum((labor_tax - mean(labor_tax)).^2);
end

% Find the best fit (highest R-squared value)
[best_rsquared, best_order] = max(rsquared_values);
best_order = orders(best_order);

% Fit polynomial with the best order
best_p = polyfit(num_tax_payments, labor_tax, best_order);
best_y_fit = polyval(best_p, num_tax_payments);

% Visualize the fit
figure;
scatter(num_tax_payments, labor_tax, 'b', 'filled');
hold on;
plot(num_tax_payments, best_y_fit, 'r', 'LineWidth', 2);
xlabel('Number of Tax Payments');
ylabel('Labor Tax');
title(['Best Fit: Polynomial Order ', num2str(best_order), ', R^2 = ', num2str(best_rsquared)]);
legend('Data', 'Best Fit');
grid on;
hold off;